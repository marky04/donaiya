<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Donaiya</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="robots" content="no-index, no-follow" /><!--index, follow-->

<!-- Responsive and mobile friendly stuff -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">

<link type="text/css" rel="stylesheet" href="css/style.donaiya.css" />
<link type="text/css" rel="stylesheet" href="css/flexslider.css"  />
</head>
<body>
	<div id="mobile_body"></div>

	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
	<script src="js/jquery.js"></script>
	<script type="text/javascript" src="js/jquery.swipe.js"></script>
	<script type="text/javascript" src="js/jquery.flexslider-min.js"></script>
	<script type="text/javascript" src="js/jquery.krioImageLoader.js"></script>
	<script src="js/jquery.imagesloaded.min.js"></script>
	<script src="js/imgcache.js"></script>
	<script type="text/javascript">
	HomeAjaxLoader();
	function HomeAjaxLoader()
	{
		//var link = 'http://localhost/ci_donaiya/';
		var link = 'http://donaiya.nextus.asia';
		$.ajax({
			url: link,
			success: function(data)
			{
				var home_page_exist = false;
				$('#mobile_body div').filter(function (index)
				{
					if($(this).attr('id') == 'home-holder')
					{
						home_page_exist = true;
					}
				});
				
				if(!home_page_exist)
				{
					$('#mobile_body').append('<div id="home-holder">');
				}

				$('#home-holder').html(data);
				LoadFooterNavigation();
			}
		});
	}
	
	//image cache
	var startTest = function() {
		$('body').imagesLoaded(function($images, $proper, $broken ) {

			// see console output for debug info
			ImgCache.options.debug = true;
			ImgCache.options.usePersistentCache = true;

			ImgCache.init(function() {
				// 1. cache images
				for (var i = 0; i < $proper.length; i++) {
					ImgCache.cacheFile($($proper[i]).attr('src'));
				}
				// 2. broken images get replaced
				for (var i = 0; i < $broken.length; i++) {
					ImgCache.useCachedFile($($broken[i]));
				}

			});
		});
	};

	if (typeof(cordova) !== 'undefined') {
		// cordova test
		document.addEventListener('deviceready', startTest, false);
	} else {
		// normal browser test
		$(document).ready(startTest);
	}
	//eof image cache

	function AjaxServerReponse(destination_url, result_holder, id)
	{
		var sub_page_exist = false;
		$('#' + result_holder + ' div').filter(function (index)
		{
			if($(this).attr('id') == id)
			{
				sub_page_exist = true;
			}
		});

		if(sub_page_exist)
		{
			$('#' + id).show();
			$('#' + id).stop().animate(
			{
				right:0
			}, 100, function()
			{
				$('#' + id).children('header').removeClass('sub-page-header');
				$('#return_button').attr('onClick', 'LoadPreviousContent(\'' + id + '\');');
				$('#home-holder').hide();
			});
		}
		else
		{
			$.ajax({
				url: destination_url,
				success: function(data) {
					$('#' + result_holder).append('<div id="' + id + '" class="sub-page" style="right:-' + $(document).width() + 'px;">' + data + '</div>');
					$('#' + id).stop().animate(
					{
						right:0
					}, 100, function()
					{
						$('#' + id).children('header').removeClass('sub-page-header');
						$('#' + id + ' .return-button').attr('onClick', 'LoadPreviousContent(\'' + id + '\');');
						$('#home-holder').hide();
					});
				}
			});
		}
	}

	function LoadPreviousContent(id)
	{
		$('#home-holder').show();
		$('#' + id).children('header').addClass('sub-page-header');
		$('#' + id).stop().animate(
		{
			right:-$(document).width()
		}, 100, function()
		{
			$(this).hide();
		});
	}

	function LoadSideNavigation()
	{
		$('.menu-button').click(function(){

			if($(this).hasClass('active')){
				$(this).removeClass('active');
				$('.nav-container').animate({right:"-"+100+"%"}, 300);

			}else {
				$(this).addClass('active');
				$('.nav-container').animate({right:0}, 300);
			}
		});
	}

	function LoadFooterNavigation()
	{
		var activ = 0;
		var next  = activ + 1;
		var prev;
		var $current = $('.footer-nav-wrapper ul:eq('+ activ +')');

		$('.footer-nav-wrapper ul').css('left','100%');
		$current.addClass('active').css('left',0);

		$('#footer-next').click(function() {

			$current = $('.footer-nav-wrapper ul:eq('+ activ +')');
			if($current.next().length){
				$current.animate({left: '-'+100+'%'}).removeClass('active');
				$current.next().animate({left: 0});

				activ = activ + 1;
				addMarker(activ);
			}
		});

		$('#footer-prev').click(function(){

			$current = $('.footer-nav-wrapper ul:eq('+ activ +')');
			if($current.prev().length){
				$current.animate({left: '+'+100+'%'}).removeClass('active');
				$current.prev().animate({left: 0});

				activ = activ - 1;
				addMarker(activ);
			}
		});

		var menuCount =  $('.footer-nav-wrapper ul').length;
		for( var z = 0 ; z < menuCount ; z++){
			$('#footer-nav-marker').append('<li><a></a></li>');
		}

		$('#footer-nav-marker li:eq('+ activ +')').addClass('footer-nav-active');

		$('#home-footer').touchSwipeLeft(function()
		{
			$current = $('.footer-nav-wrapper ul:eq('+ activ +')');

			if($current.next().length){
				$current.animate({left: '-'+100+'%'}).removeClass('active');
				$current.next().animate({left: 0});

				activ = activ + 1;
				addMarker(activ);
			}
		}); 
		
		$('#home-footer').touchSwipeRight(function()
		{
			$current = $('.footer-nav-wrapper ul:eq('+ activ +')');

			if($current.prev().length){
				$current.animate({left: '+'+100+'%'}).removeClass('active');
				$current.prev().animate({left: 0});

				activ = activ - 1;
				addMarker(activ);
			}
		});
	}

	function addMarker(x)
	{
		$('.footer-nav-wrapper ul:eq('+ x +')').addClass('active');
		$('#footer-nav-marker li:eq('+ x +')').addClass('footer-nav-active');
		$('#footer-nav-marker li:eq('+ x +')').siblings().removeClass('footer-nav-active');
	}

	function LoadExternalLink(website_url)
	{
		window.plugins.childBrowser.showWebPage(website_url, {showAddress:false, showNavigationBar:true});
		/*if(device.platform == 'iOS')
		{
			var ref = window.open(encodeURI(website_url), '_blank', 'EnableViewPortScale=yes');
		}
		else
		{
			var ref = window.open(encodeURI(website_url), '_blank', 'location=yes');
		}*/
	}
	</script>
	<script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
	<script type="text/javascript" charset="utf-8" src="cordova-2.5.0.js"></script>
	<script type="text/javascript" charset="utf-8" src="js/childbrowser.js"></script>
</body>
</html>